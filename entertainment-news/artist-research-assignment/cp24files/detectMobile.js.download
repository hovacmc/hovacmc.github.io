function redirectTo(redirectURL){window.location.href=redirectURL;}function setCookieAndRedirect(mode,redirectURL){jQuery.cookie("permPref",mode,{expires:100,path:"/"});redirectTo(redirectURL);}function setCookieAndLoadSiteByMode(mode){if(MobileEsp.IsIphone||MobileEsp.IsAndroidPhone||MobileEsp.DetectMobileQuick()){if(confirm("Save your preference?")){jQuery.cookie("permPref",mode,{expires:100,path:"/"});}else{var cookieDuration=new Date();cookieDuration.setTime(cookieDuration.getTime()+(30*60*1000));jQuery.cookie("currPref",mode,{expires:cookieDuration,path:"/"});}}var currURL=window.location.href;if(mode=="www"){var targetURL=getDesktopUrl(currURL);redirectTo(targetURL);}else{if(mode=="mobile"){var targetURL=getMobileUrl(currURL);redirectTo(targetURL);}}}function getMobileUrl(desktopUrl){var fullURL=document.createElement("a");fullURL.href=desktopUrl;var index_firstSlashAfterDomain=desktopUrl.indexOf("/",desktopUrl.indexOf(fullURL.hostname));var mobileURL=desktopUrl.substring(0,index_firstSlashAfterDomain)+"/mobile"+desktopUrl.substring(index_firstSlashAfterDomain);mobileURL=mobileURL.replace("/www/","/");return mobileURL;}function getDesktopUrl(mobileUrl){var desktopURL=mobileUrl.replace("/mobile/","/");return desktopURL;}function detectMobile(){var wwwSite=window.location.href;var mobileURL=getMobileUrl(wwwSite);var savedPref=jQuery.cookie("permPref");var currPref=jQuery.cookie("currPref");var noRedirect=false;if(wwwSite.indexOf("noRedirect=true")>-1){noRedirect=true;}if(currPref&&currPref=="www"){noRedirect=true;}if(!noRedirect){if(savedPref){if(savedPref=="mobile"){var type="other";redirectTo(mobileURL);}else{if(savedPref=="www"){return;}}}else{if(MobileEsp.IsIphone){var type="iphone";redirectTo(mobileURL);}else{if(MobileEsp.IsAndroidPhone){var type="android";redirectTo(mobileURL);}else{if(MobileEsp.DetectMobileQuick()){var type="other";redirectTo(mobileURL);}}}}}}function sendToMobileChoicePage(type,redirect){var divToWrite=document.getElementById("insertForm");var myForm=document.createElement("form");myForm.setAttribute("action","#");myForm.setAttribute("name","mobile");myForm.setAttribute("method","get");myForm.setAttribute("style","display:none;");addHiddenValueToForm(myForm,"ot","Html5MobileRedirectPageLayout.ot");addHiddenValueToForm(myForm,"type",type);addHiddenValueToForm(myForm,"redirect",redirect);if(getURLParameter("binId")!=""){addHiddenValueToForm(myForm,"binId",getURLParameter("binId"));}if(getURLParameter("playlistId")!=""){addHiddenValueToForm(myForm,"playlistId",getURLParameter("playlistId"));}if(getURLParameter("clipId")!=""){addHiddenValueToForm(myForm,"clipId",getURLParameter("clipId"));}if(getURLParameter("playlistPageNum")!=""){addHiddenValueToForm(myForm,"playlistPageNum",getURLParameter("playlistPageNum"));}divToWrite.appendChild(myForm);myForm.submit();}function getURLParameter(name){return decodeURIComponent((RegExp(name+"=(.+?)(&|$)").exec(location.search)||[,""])[1]);}function addHiddenValueToForm(targetForm,name,value){if(targetForm!=null){var hiddenInput=document.createElement("input");hiddenInput.setAttribute("type","hidden");hiddenInput.setAttribute("name",name);hiddenInput.setAttribute("value",value);targetForm.appendChild(hiddenInput);}}